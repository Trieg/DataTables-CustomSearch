/*! jQuery DataTables Custom Search Plugin - v0.8 (2014-04-07) | Copyright 2014 Timothy Ruhle; Licensed MIT */
!function(e,t,i){"use strict";var a=function(e,t){var a=function(t,i){if(!(this instanceof a))throw'Warning: CustomSearch must be initialised with the keyword "new".';if(!e.fn.dataTableExt.fnVersionCheck("1.10.0"))throw"Warning: CustomSearch requires DataTables 1.10 or greater.";return this.c={fields:[],container:"",hideStandardSearch:!1},this.s={dt:null,init:null,table:null},this.init(t,i),this};return a.prototype={init:function(n,s){var l,r,d,h,o,c,f,u,m,p,g,b=this,v=[],y=[];if(this.s.dt=new t.Api(n).settings()[0],this.s.init=s||{},this.s.table=e(this.s.dt.nTable),e.extend(!0,this.c,a.defaults,s),this.c.hideStandardSearch===!0&&e("#"+this.s.dt.sInstance+"_filter").hide(),null===this.c.fields||this.c.fields===i||0===this.c.fields.length)for(this.c.fields=[],l=0;l<this.s.dt.aoColumns.length;l++)this.c.fields.push(l);for(e.isArray(this.c.fields)||(this.c.fields=[this.c.fields]),l=0;l<this.c.fields.length;l++){if(o=this.c.fields[l],(!isNaN(o)||e.isArray(o))&&(o={columns:o}),o.columns=e.isArray(o.columns)?o.columns:[o.columns],o.columns.sort(),o.multiple=this.getMultiple(o.multiple),o.type=this.getType(o.type,o.columns),o.range=this.getRange(o.range),o.label=this.getLabel(o.label,o.range,o.columns),o.id=this.getId(l,o.range,o.field),o.advanced=this.getAdvanced(o.advanced,o.range,o.id,o.type),o.server=this.getServer(o.server,o.id),o.caseInsensitive=o.caseInsensitive!==!1,o.smart=o.smart===!0,o=this.getField(o),this.c.fields[l]=o,0===o.range.length)y.push(o.id);else for(h in o.id)y.push(o.id[h]);o.advanced&&o.advanced.id&&y.push(o.advanced.id),v.push(o.fullField)}if(this.c.fields.sort(this.sortBySubArray),"thead"===this.c.container||"thead:before"===this.c.container||"thead:after"===this.c.container||"tfoot"===this.c.container||"tfoot:before"===this.c.container||"tfoot:after"===this.c.container)for(c=this.c.container.indexOf("thead")>=0?"thead":"tfoot",f=this.s.table.find(c),u=0,m=1,p="prependTo",this.c.container===c+":after"&&(p="appendTo"),0===f.length&&this.s.table.append("<"+c+">"),f=this.s.table.find(c),g=e("<tr>")[p](f),l=0;l<this.c.fields.length;l++)for(r=0;r<this.c.fields[l].columns.length;r++){for(;this.c.fields[l].columns[r]>u;)g.append(e("<td>")),u++;if(1===this.c.fields[l].columns.length)g.append(e("<td>").append(this.c.fields[l].field));else{for(m=1,d=r+1;d<this.c.fields[l].columns.length&&this.c.fields[l].columns[d]===this.c.fields[l].columns[r]+1;d++)m++,u++;g.append(e("<td>").attr("colspan",m).append(e(this.c.fields[l].field))),r=d}u++}else this.c.container?e(this.c.container).append("<div>"+v.join("")+"</div>"):e(this.s.dt.nTableWrapper).prepend("<div>"+v.join("")+"</div>");e("#"+y.join(",#")).change(function(){if(b.s.dt.oInit.serverSide){var t=b.s.dt.ajax;for("string"==typeof t&&(t={url:t,data:{}}),t.data.customsearch={},l=0;l<b.c.fields.length;l++)t.data.customsearch[b.c.fields[l].server]=e("#"+b.c.fields[l].id).val();b.s.dt.ajax=t}b.s.table.DataTable().draw()}),this.s.dt.oInit.serverSide||this.s.table.dataTable().DataTable.ext.search.push(function(e,t,i){return b.search(e,t,i)}),e.isFunction(this.c.after)&&this.s.table.on("search.dt",function(e,t){var i=t.aiDisplay,a=b.s.table.DataTable().data(),n=[],s=[],l=t._iDisplayStart,r=t._iDisplayStart+t._iDisplayLength;for(r>a.length&&(r=a.length),r>i.length&&(r=i.length);r>l;l++)n.push(a[i[l]]);for(l=0;l<i.length;l++)s.push(a[i[l]]);b.c.after(n,s,a)})},search:function(t,i){var a,n,s,l,r,d,h,o;for(a=0;a<this.c.fields.length;a++)if(d=this.c.fields[a],o=d.advanced?e("#"+d.advanced.id).val():!1,0===d.range.length){if(l=e("#"+d.id).val(),l||(l=""),l.length){if(s=!1,"date"!=d.type||o){for(h=[],n=0;n<d.columns.length;n++)h.push(i[d.columns[n]]);this.searchString(h.join(" "),l,o,d.caseInsensitive,d.smart)&&(s=!0)}else for(n=0;n<d.columns.length;n++)if(this.searchDate(i[d.columns[n]],l)){s=!0;break}if(s===!1)return!1}}else{for(r={min:this.hasRange("min",d.range)?e("#"+d.id.min).val():"",max:this.hasRange("max",d.range)?e("#"+d.id.max).val():""},s=!1,n=0;n<d.columns.length;n++)if("date"==d.type){if(this.searchDateRange(i[d.columns[n]],r)){s=!0;break}}else if(this.searchNumberRange(i[d.columns[n]],r)){s=!0;break}if(s===!1)return!1}return!0},searchString:function(e,t,i,a,n){var s=!1;return s=null!==t&&t.length?this.searchStringAdvanced(e,t,i,a,n):!0},searchStringAdvanced:function(t,i,a,n){var s,l,r=0;for(n&&(t=t.toLowerCase()),s=parseInt(t,10),e.isArray(i)||(i=[i]);r<i.length;r++){if(n&&(i[r]=i[r].toLowerCase()),l=parseInt(i[r],10),!(a&&"contains"!=a||-1==t.search(i[r])))return!0;if("not-contains"==a&&-1==t.search(i[r]))return!0;if("equal"==a&&t==i[r])return!0;if("not-equal"==a&&t!=i[r])return!0;if("greater"==a&&s>l)return!0;if("less"==a&&l>s)return!0;if("begins"==a&&0===t.indexOf(i[r]))return!0}return!1},searchNumberRange:function(e,t){return e=parseInt(e.replace(/[^\d]/i,""),10),t.min=parseInt(t.min,10),t.max=parseInt(t.max,10),isNaN(e)?!1:isNaN(t.min)&&isNaN(t.max)||isNaN(t.min)&&t.max>=e||t.min<=e&&isNaN(t.max)||t.min<=e&&t.max>=e},searchDate:function(e,t){return e=new Date(e),t=new Date(t),this.isValidDate(e)&&e==t},searchDateRange:function(e,t){return e=new Date(e),t.min=new Date(t.min),t.max=new Date(t.max),this.isValidDate(e)?!this.isValidDate(t.min)&&!this.isValidDate(t.max)||!this.isValidDate(t.min)&&t.max>=e||t.min<=e&&!this.isValidDate(t.max)||t.min<=e&&t.max>=e:!1},isValidDate:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},getRange:function(t){var a=[],n=!1,s=!1;return"string"==typeof t&&(a=t.split(",")),e.isArray(t)&&(n=this.hasRange("min",t),s=this.hasRange("max",t),a=n&&s?["min","max"]:n&&!s?["min"]:!n&&s?["max"]:[]),t===i&&(a=[]),t===!0&&(a=["min","max"]),a},getField:function(t){var i=e(t.field);return t.field&&0!==i.length||(i=this.createField(t)),i},createField:function(t){var i;switch(t.fieldLabel=[],t.field=[],t.type){case"string":t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<input type="text" id="'+t.id+'">';break;case"number":0===t.range.length?(t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<input type="number" id="'+t.id+'">'):(this.hasRange("min",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.min+'">'+t.label.min+"</label>"),t.field.push('<input type="number" id="'+t.id.min+'">')),this.hasRange("max",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.max+'">'+t.label.max+"</label>"),t.field.push('<input type="number" id="'+t.id.max+'">')));break;case"select":for(t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<select id="'+t.id+'"',t.multiple&&(t.field+=' multiple="multiple"'),t.field+=">",e.isArray(t.options)&&0!==t.options.length?t.multiple||t.options.unshift({value:"",text:"All"}):(t.options=t.multiple?[]:[{value:"",text:"All"}],e.each(this.s.dt.aoData,function(i,a){-1===e.inArray(a._aData[t.columns],t.options)&&t.options.push(a._aData[t.columns])})),i=0;i<t.options.length;i++)t.field+="object"==typeof t.options[i]?'<option value="'+t.options[i].value+'">'+t.options[i].text+"</option>":'<option value="'+t.options[i]+'">'+t.options[i]+"</option>";t.field+="</select>";break;case"date":0===t.range.length?(t.label&&(t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"),t.field=t.advanced.field+'<input type="date" id="'+t.id+'">'):(this.hasRange("min",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.min+'">'+t.label.min+"</label>"),t.field.push('<input type="date" id="'+t.id.min+'">')),this.hasRange("max",t.range)&&(t.label&&t.fieldLabel.push('<label for="'+t.id.max+'">'+t.label.max+"</label>"),t.field.push('<input type="date" id="'+t.id.max+'">')));break;default:throw"Warning: CustomSearch init failed due to invalid field type given - "+t.type}if(t.fullField="",e.isArray(t.field))for(i=0;i<t.field.length;i++)t.fullField+=t.fieldLabel[i],t.fullField+=t.field[i];else t.fullField+=t.fieldLabel,t.fullField+=t.field;return t},getMultiple:function(e){return e===!0},getId:function(t,i,a){var n,s,l=this.s.dt.sInstance+"_"+t;return 0===i.length?n=l:(n={},this.hasRange("min",i)&&(n.min=l+"_min"),this.hasRange("max",i)&&(n.max=l+"_max")),e(a).length>0&&(s=e(a).attr("id"),s?n=s:e(a).attr("id",n)),n},getAdvanced:function(e,t,i,a){var n,s="",l=i+"_advanced",r="number"==a||"date"==a,d=[["contains","Contains",!r],["not-contains","Does Not Contain",!1],["equal","Is Equal To",r],["not-equal","Is Not Equal To",!1]];if(r?(d.push(["greater","Is Greather Than",!1]),d.push(["less","Is Less Than",!1])):d.push(["begins","Begins With",!1]),e===!0&&0===t.length){for(s+='<select id="'+l+'">',n=0;n<d.length;n++)s+='<option value="'+d[n][0]+'"',d[n][2]&&(s+=' selected="selected"'),s+=">"+d[n][1]+"</option>";return s+="</select>",{id:l,field:s}}return{id:"",field:""}},getServer:function(e,t){return e?e:t},getLabel:function(e,t,a){var n,s="";if(e===i){for(e=[],n=0;n<a.length;n++)e.push(this.s.dt.aoColumns[a[n]].sTitle);e=e.join(" & ")}return 0===t.length?s=e:(s={},this.hasRange("min",t)&&(s.min="Min "+e),this.hasRange("max",t)&&(s.max="Max "+e)),s},getType:function(e,t){var i=e;return i||(1==t.length?(i=this.s.dt.aoColumns[t[0]].sType,("num"==i||"currency"==i||"num-fmt"==i)&&(i="number")):i="string"),i.toLowerCase()},hasRange:function(t,i){return e.inArray(t,i)>=0},sortBySubArray:function(t,i){var a=t.columns,n=i.columns;return e.isArray(a)&&(a=Math.min.apply(Math,a)),e.isArray(n)&&(n=Math.min.apply(Math,n)),a-n}},t.CustomSearch=a,a};"function"==typeof define&&define.amd?define("datatables-customsearch",["jquery","datatables"],a):jQuery&&!jQuery.fn.dataTable.CustomSearch&&a(jQuery,jQuery.fn.dataTable)}(window,document);