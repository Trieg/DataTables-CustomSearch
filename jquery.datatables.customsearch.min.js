/*! jQuery DataTables Custom Search Plugin - v0.8.5 (2014-04-07) | Copyright 2014 Timothy Ruhle; Licensed MIT */
(function(e,t,n){"use strict";var r=function(e,t){var r=function(t,n){var i=this;if(!(this instanceof r)){throw'Warning: CustomSearch must be initialised with the keyword "new".'}if(!e.fn.dataTableExt.fnVersionCheck("1.10.0")){throw"Warning: CustomSearch requires DataTables 1.10 or greater."}this.c={fields:[],container:"",hideStandardSearch:true};this.s={dt:null,init:null,table:null};e(t).on("init.dt",function(){i.init(t,n)});return this};r.prototype={init:function(i,s){var o=this,u,a,f,l,c,h=[],p,d,v,m,g,y;this.s.dt=(new t.Api(i)).settings()[0];this.s.init=s||{};this.s.table=e(this.s.dt.nTable);e.extend(true,this.c,r.defaults,s);if(this.c.hideStandardSearch===true){e("#"+this.s.dt.sInstance+"_filter").hide()}if(this.c.fields===null||this.c.fields===n||this.c.fields.length===0){this.c.fields=[];for(u=0;u<this.s.dt.aoColumns.length;u++){this.c.fields.push(u)}}if(!e.isArray(this.c.fields)){this.c.fields=[this.c.fields]}for(u=0;u<this.c.fields.length;u++){c=this.c.fields[u];if(!isNaN(c)||e.isArray(c)){c={columns:c}}c.columns=e.isArray(c.columns)?c.columns:[c.columns];c.columns.sort();c.multiple=this.getMultiple(c.multiple);c.type=this.getType(c.type,c.columns);c.dataType=this.getDataType(c.columns);c.range=this.getRange(c.range);c.slider=c.slider===true&&this.hasRange("min",c.range)&&this.hasRange("max",c.range);c.label=this.getLabel(c.label,c.range,c.columns,c.slider);c.id=this.getId(u,c.range,c.field,c.slider);c.advanced=this.getAdvanced(c.advanced,c.range,c.id,c.type);c.server=this.getServer(c.server,c.id);c.caseInsensitive=c.caseInsensitive!==false;c.smart=c.smart===true;c.autocomplete=c.autocomplete===true;c.chosen=c.chosen===true;c.trigger=c.trigger==="key"?"keyup":"change";c=this.getField(c);this.c.fields[u]=c;h.push(c.fullField)}this.c.fields.sort(this.sortBySubArray);if(this.c.container==="thead"||this.c.container==="tfoot"){p=this.c.container.indexOf("thead")>=0?"thead":"tfoot";d=this.s.table.find(p);y=d.find("tr");if(d.length===0){this.s.table.append("<"+p+">");d=this.s.table.find(p);y=e("<tr>").appendTo(d);for(u=0;u<this.s.dt.aoColumns.length;u++){y.append(e("<th>").toggle(this.s.dt.aoColumns[u].bVisible))}}for(u=0;u<this.c.fields.length;u++){y.find("th").eq(this.c.fields[u].columns[0]).append(this.c.fields[u].field)}}else if(this.c.container==="thead:before"||this.c.container==="thead:after"||this.c.container==="tfoot:before"||this.c.container==="tfoot:after"){p=this.c.container.indexOf("thead")>=0?"thead":"tfoot";d=this.s.table.find(p);v=0;m=1;g="prependTo";if(this.c.container===p+":after"){g="appendTo"}if(d.length===0){this.s.table.append("<"+p+">")}d=this.s.table.find(p);y=e("<tr>")[g](d);for(u=0;u<this.c.fields.length;u++){for(a=0;a<this.c.fields[u].columns.length;a++){while(this.c.fields[u].columns[a]>v){y.append(e("<td>"));v++}if(this.c.fields[u].columns.length===1){y.append(e("<td>").append(this.c.fields[u].field))}else{m=1;for(f=a+1;f<this.c.fields[u].columns.length;f++){if(this.c.fields[u].columns[f]===this.c.fields[u].columns[a]+1){m++;v++}else{break}}y.append(e("<td>").attr("colspan",m).append(e(this.c.fields[u].field)));a=f}v++}}}else{if(!this.c.container){e(this.s.dt.nTableWrapper).prepend("<div>"+h.join("")+"</div>")}else{e(this.c.container).append("<div>"+h.join("")+"</div>")}}for(u=0;u<this.c.fields.length;u++){c=this.c.fields[u];if(c.autocomplete){e("#"+c.id).autocomplete({source:o.getDistinctValuesInColumn(c.columns,c.dataType,true),select:function(t,n){e(this).val(n.item.label);o.triggerSearch()}})[c.trigger](function(){o.triggerSearch()});}else if(c.slider){var a=this.getDistinctValuesInColumn(c.columns,c.dataType,true);e("#"+c.id).slider({min:o.intParse(a[0]),max:o.intParse(a[a.length-1]),values:[o.intParse(a[0]),o.intParse(a[a.length-1])],range:true,slide:function(t,n){e("#"+this.id+"_display").text(n.values[0]+" - "+n.values[1]);o.triggerSearch()}});e("#"+c.id+"_display").text(a[0]+" - "+a[a.length-1])}else{l=[];if(c.range.length===0){l.push(c.id)}else{for(a in c.id){l.push(c.id[a])}}e("#"+l.join(",#"))[c.trigger](function(){o.triggerSearch()});if(c.chosen){e("#"+l.join(",#")).chosen({allow_single_deselect:true,width:"100%"})}if(c.type==="switch"){e("#"+c.id).buttonset()}}}if(!this.s.dt.oInit.serverSide){this.s.table.dataTable().DataTable.ext.search.push(function(e,t,n){if(e.nTable.id===o.s.dt.nTable.id){return o.search(e,t,n)}return true})}if(e.isFunction(this.c.after)){this.s.table.on("search.dt",function(e,t){var n=t.aiDisplay,r=o.s.table.DataTable().data(),i=[],s=[],u=t._iDisplayStart,a=t._iDisplayStart+t._iDisplayLength;if(a>r.length){a=r.length}if(a>n.length){a=n.length}for(;u<a;u++){i.push(r[n[u]])}for(u=0;u<n.length;u++){s.push(r[n[u]])}o.c.after(i,s,r)})}},search:function(t,n,r){var i,s,o,u,a,f,l,c;for(i=0;i<this.c.fields.length;i++){f=this.c.fields[i];if(f.advanced){c=e("#"+f.advanced.id).val()}else{c=false}if(f.range.length===0){if(f.type==="switch"){u=[];e("#"+f.id+" input:checked").each(function(){u.push(e(this).val())})}else{u=e("#"+f.id).val()}if(!u){u=""}if(u.length){o=false;if(f.type=="date"&&!c){for(s=0;s<f.columns.length;s++){if(this.searchDate(n[f.columns[s]],u)){o=true;break}}}else{l=[];for(s=0;s<f.columns.length;s++){l.push(n[f.columns[s]])}if(this.searchString(l.join(" "),u,c,f.caseInsensitive,f.smart)){o=true}}if(o===false){return false}}}else{if(f.slider){a={min:e("#"+f.id).slider("values",0),max:e("#"+f.id).slider("values",1)}}else{a={min:this.hasRange("min",f.range)?e("#"+f.id.min).val():"",max:this.hasRange("max",f.range)?e("#"+f.id.max).val():""}}if(!a.min){a.min=""}if(!a.max){a.max=""}if(a.min||a.max){o=false;for(s=0;s<f.columns.length;s++){if(f.type=="date"){if(this.searchDateRange(n[f.columns[s]],a)){o=true;break}}else{if(this.searchNumberRange(n[f.columns[s]],a)){o=true;break}}}if(o===false){return false}}}}return true},searchString:function(e,t,n,r,i){var s=false;if(t===null||!t.length){s=true}else{s=this.searchStringAdvanced(e,t,n,r,i)}return s},searchStringAdvanced:function(t,n,r,i,s){var o=0,u,a;if(i){t=t.toLowerCase()}u=this.intParse(t);if(!e.isArray(n)){n=[n]}for(;o<n.length;o++){if(i){n[o]=n[o].toLowerCase()}a=this.intParse(n[o]);if((!r||r=="contains")&&t.search(n[o])!=-1){return true}else if(r=="not-contains"&&t.search(n[o])==-1){return true}else if(r=="equal"&&t==n[o]){return true}else if(r=="not-equal"&&t!=n[o]){return true}else if(r=="greater"&&u>a){return true}else if(r=="less"&&u<a){return true}else if(r=="begins"&&t.indexOf(n[o])===0){return true}}return false},searchNumberRange:function(e,t){e=this.intParse(e.toString().replace(/[^\d]/i,""));t.min=this.intParse(t.min);t.max=this.intParse(t.max);if(isNaN(e)){return false}return isNaN(t.min)&&isNaN(t.max)||isNaN(t.min)&&t.max>=e||t.min<=e&&isNaN(t.max)||t.min<=e&&t.max>=e},searchDate:function(e,t){e=new Date(e);t=new Date(t);return this.isValidDate(e)&&e==t},searchDateRange:function(e,t){e=new Date(e);t.min=new Date(t.min);t.max=new Date(t.max);if(!this.isValidDate(e)){return false}return!this.isValidDate(t.min)&&!this.isValidDate(t.max)||!this.isValidDate(t.min)&&t.max>=e||t.min<=e&&!this.isValidDate(t.max)||t.min<=e&&t.max>=e},isValidDate:function(e){return Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e.getTime())},getRange:function(t){var r=[],i=false,s=false;if(typeof t==="string"){r=t.split(",")}if(e.isArray(t)){i=this.hasRange("min",t);s=this.hasRange("max",t);if(i&&s){r=["min","max"]}else if(i&&!s){r=["min"]}else if(!i&&s){r=["max"]}else{r=[]}}if(t===n){r=[]}if(t===true){r=["min","max"]}return r},getField:function(t){var n=e(t.field);if(!t.field||n.length===0){n=this.createField(t)}return n},createField:function(t){var n,r;t.fieldLabel=[];t.field=[];switch(t.type){case"string":if(t.label){t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"}t.field=t.advanced.field+'<input type="text" id="'+t.id+'">';break;case"number":case"date":if(t.range.length===0){if(t.label){t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"}t.field=t.advanced.field+'<input type="'+t.type+'" id="'+t.id+'">'}else{if(t.slider){t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>";t.field=t.advanced.field+'<div id="'+t.id+'"></div><div id="'+t.id+'_display"></div>'}else{if(this.hasRange("min",t.range)){if(t.label){t.fieldLabel.push('<label for="'+t.id.min+'">'+t.label.min+"</label>")}t.field.push('<input type="'+t.type+'" id="'+t.id.min+'">')}if(this.hasRange("max",t.range)){if(t.label){t.fieldLabel.push('<label for="'+t.id.max+'">'+t.label.max+"</label>")}t.field.push('<input type="'+t.type+'" id="'+t.id.max+'">')}}}break;case"select":if(t.label){t.fieldLabel='<label for="'+t.id+'">'+t.label+"</label>"}if(!e.isArray(t.options)||t.options.length===0){t.options=this.getDistinctValuesInColumn(t.columns,t.dataType,true)}t.field=t.advanced.field+'<select id="'+t.id+'"';if(t.multiple){t.field+=' multiple="multiple"'}t.field+=">";if(!t.multiple){t.options.unshift({value:"",text:t.chosen?"":"All"})}for(n=0;n<t.options.length;n++){if(typeof t.options[n]==="object"){t.field+='<option value="'+t.options[n].value+'">'+t.options[n].text+"</option>"}else{t.field+='<option value="'+t.options[n]+'">'+t.options[n]+"</option>"}}t.field+="</select>";break;case"switch":if(!e.isArray(t.options)||t.options.length===0){t.options=this.getDistinctValuesInColumn(t.columns,t.dataType,true)}for(n=0;n<t.options.length;n++){if(typeof t.options[n]==="object"){t.field.push('<input type="checkbox" id="'+t.id+"_"+n+'" name="'+t.id+'"'+t.options[n].value+">");t.field.push('<label for="'+t.id+"_"+n+'">'+t.options[n].text+"</label>")}else{t.field.push('<input type="checkbox" id="'+t.id+"_"+n+'" name="'+t.id+'" value="'+t.options[n]+'">');t.field.push('<label for="'+t.id+"_"+n+'">'+t.options[n]+"</label>")}}t.field.unshift('<div id="'+t.id+'">');t.field.push("</div>");t.field=t.field.join("");break;default:throw"Warning: CustomSearch init failed due to invalid field type given - "+t.type;break}t.fullField="";if(e.isArray(t.field)){for(n=0;n<t.field.length;n++){t.fullField+=t.fieldLabel[n];t.fullField+=t.field[n]}}else{t.fullField+=t.fieldLabel;t.fullField+=t.field}return t},getDistinctValuesInColumn:function(t,n,r){var i=[],s=this;e.each(this.s.dt.aoData,function(n,r){var s=[];if(e.isArray(t)){for(var o=0;o<t.length;o++){s.push(r._aData[t[o]])}}else{s.push(r._aData[t])}s=s.join(" ");if(e.inArray(s,i)===-1){i.push(s)}});if(r){if(n==="string"||n==="date"){i.sort()}else{i.sort(function(e,t){return s.intParse(e)-s.intParse(t)})}}return i},getMultiple:function(e){return e===true},intParse:function(e){return parseInt(e.toString().replace(/[^\d]/i,""),10)},getId:function(t,n,r,i){var s=this.s.dt.sInstance+"_"+t,o,u;if(n.length===0||i){o=s}else{o={};if(this.hasRange("min",n)){o.min=s+"_min"}if(this.hasRange("max",n)){o.max=s+"_max"}}if(e(r).length>0){u=e(r).attr("id");if(u){o=u}else{e(r).attr("id",o)}}return o},getAdvanced:function(e,t,n,r){var i="",s,o=n+"_advanced",u=r=="number"||r=="date",a=[["contains","Contains",!u],["not-contains","Does Not Contain",false],["equal","Is Equal To",u],["not-equal","Is Not Equal To",false]];if(u){a.push(["greater","Is Greather Than",false]);a.push(["less","Is Less Than",false])}else{a.push(["begins","Begins With",false])}if(e===true&&t.length===0){i+='<select id="'+o+'">';for(s=0;s<a.length;s++){i+='<option value="'+a[s][0]+'"';if(a[s][2]){i+=' selected="selected"'}i+=">"+a[s][1]+"</option>"}i+="</select>";return{id:o,field:i}}return{id:"",field:""}},getServer:function(e,t){return e?e:t},getLabel:function(e,t,r,i){var s="",o;if(e===n){e=[];for(o=0;o<r.length;o++){e.push(this.s.dt.aoColumns[r[o]].sTitle)}e=e.join(" & ")}if(t.length===0||i){s=e}else{s={};if(this.hasRange("min",t)){s.min="Min "+e}if(this.hasRange("max",t)){s.max="Max "+e}}return s},getType:function(e,t){var n=e;if(!n){if(t.length==1){n=this.s.dt.aoColumns[t[0]].sType;if(n=="num"||n=="currency"||n=="num-fmt"){n="number"}}else{n="string"}}return n.toLowerCase()},getDataType:function(e){var t="string";if(e.length==1){t=this.s.dt.aoColumns[e[0]].sType;if(t=="num"||t=="currency"||t=="num-fmt"){t="number"}}return t.toLowerCase()},hasRange:function(t,n){return e.inArray(t,n)>=0},sortBySubArray:function(t,n){var r=t.columns,i=n.columns;if(e.isArray(r)){r=Math.min.apply(Math,r)}if(e.isArray(i)){i=Math.min.apply(Math,i)}return r-i},triggerSearch:function(){if(this.s.dt.oInit.serverSide){var t=this.s.dt.ajax;if(typeof t==="string"){t={url:t,data:{}}}t.data.customsearch={};for(j=0;j<this.c.fields.length;j++){t.data.customsearch[this.c.fields[j].server]=e("#"+this.c.fields[j].id).val()}this.s.dt.ajax=t}this.s.table.DataTable().draw()}};t.CustomSearch=r;return r};if(typeof define==="function"&&define.amd){define("datatables-customsearch",["jquery","datatables"],r)}else if(jQuery&&!jQuery.fn.dataTable.CustomSearch){r(jQuery,jQuery.fn.dataTable)}$.fn.customSearch=function(e){$(this.selector).each(function(t,n){new $.fn.dataTable.CustomSearch(this,e)});return this}})(window,document)